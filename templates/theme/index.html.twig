{% extends 'base.html.twig' %}

{% block title %}Thème — {{ theme.titre }}{% endblock %}

{% block body %}
<style>
    .wrap { max-width: 980px; margin: 0 auto; padding: 24px 20px 64px; }
    .list { display: grid; gap: 10px; }
    .row { display: grid; gap: 10px; grid-template-columns: 2fr 1fr; align-items: center; }
    .row > div { background: rgba(17, 24, 39, 0.7); border: 1px solid #1f2937; border-radius: 12px; padding: 10px; }
    .pager { display: flex; gap: 8px; margin: 18px 0; }
    .form-box { margin: 18px 0; background: rgba(17, 24, 39, 0.9); border: 1px solid #1f2937; border-radius: 12px; padding: 16px; }
</style>

<div class="wrap">
    <h1>{{ theme.titre }}</h1>

    {% if app.user %}
        <div class="form-box">
            <a class="btn primary" href="#new-sujet">Ajouter une discussion</a>
        </div>
    {% endif %}

    {% if pages > 1 %}
        <div class="pager">
            {% for p in 1..pages %}
                <a class="btn ghost" href="{{ path('app_theme', {id: theme.id, page: p}) }}">{{ p }}</a>
            {% endfor %}
        </div>
    {% endif %}

    <div class="list">
        <div class="row">
            <div><strong>Discussion</strong></div>
            <div><strong>Infos</strong></div>
        </div>
        {% for sujet in sujets %}
            <div class="row">
                <div>
                    <a href="{{ path('app_sujet', {id: sujet.id}) }}">{{ sujet.titre }}</a>
                </div>
                <div>
                    {{ sujet.auteur.pseudo }} — {{ sujet.creeLe|date('d/m/Y H:i') }}
                </div>
            </div>
        {% else %}
            <div class="row">
                <div>Aucune discussion.</div>
                <div>—</div>
            </div>
        {% endfor %}
    </div>

    {% if app.user %}
        <div class="form-box" id="new-sujet">
            <h3>Ajouter une discussion</h3>
            {{ form_start(formulaireNouveauSujet) }}
                {{ form_row(formulaireNouveauSujet.titre) }}
                {{ form_row(formulaireNouveauSujet.contenu) }}
                <button class="btn primary" type="submit">Enregistrer</button>
            {{ form_end(formulaireNouveauSujet) }}
        </div>
    {% endif %}

    {% if pages > 1 %}
        <div class="pager">
            {% for p in 1..pages %}
                <a class="btn ghost" href="{{ path('app_theme', {id: theme.id, page: p}) }}">{{ p }}</a>
            {% endfor %}
        </div>
    {% endif %}
</div>
{% endblock %}
